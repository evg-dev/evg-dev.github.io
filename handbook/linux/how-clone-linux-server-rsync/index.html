<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>How to clone linux server with rsync | evg-dev.github.io</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="og:site_name" property="og:site_name" content="evg-dev.github.io"><meta data-n-head="ssr" data-hid="og:type" property="og:type" content="article"><meta data-n-head="ssr" data-hid="description" name="description" content="How to clone linux VPS server or folder with rsync."><meta data-n-head="ssr" data-hid="og:title" property="og:title" content="How to clone linux server with rsync"><meta data-n-head="ssr" data-hid="og:description" property="og:description" content="How to clone linux VPS server or folder with rsync."><meta data-n-head="ssr" data-hid="og:url" property="og:url" content="https://evg-dev.github.io/handbook/linux/how-clone-linux-server-rsync"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" href="/_nuxt/c1207c2.js" as="script"><link rel="preload" href="/_nuxt/1c61392.js" as="script"><link rel="preload" href="/_nuxt/bcfb4b6.js" as="script"><link rel="preload" href="/_nuxt/9f49bbb.js" as="script"><link rel="preload" href="/_nuxt/727b6a8.js" as="script"><link rel="preload" href="/_nuxt/36fa5d3.js" as="script"><link rel="preload" href="/_nuxt/8211618.js" as="script"><link rel="preload" href="/_nuxt/c1ef7aa.js" as="script"><link rel="preload" href="/_nuxt/1acd4c1.js" as="script"><link rel="preload" href="/_nuxt/79af1bc.js" as="script"><link rel="preload" href="/_nuxt/aa7462a.js" as="script"><link rel="preload" href="/_nuxt/b310c4b.js" as="script"><link rel="preload" href="/_nuxt/d7a45d7.js" as="script"><link rel="preload" href="/_nuxt/f112379.js" as="script"><link rel="preload" href="/_nuxt/282e78f.js" as="script"><link rel="preload" href="/_nuxt/dbf037d.js" as="script"><link rel="preload" href="/_nuxt/0ff3dc4.js" as="script"><link rel="preload" href="/_nuxt/123fd26.js" as="script"><link rel="preload" href="/_nuxt/6b51ad5.js" as="script"><link rel="preload" href="/_nuxt/04ef250.js" as="script"><link rel="preload" href="/_nuxt/78d4aff.js" as="script"><link rel="preload" href="/_nuxt/78c712f.js" as="script"><link rel="preload" href="/_nuxt/4ad9a01.js" as="script"><link rel="preload" href="/_nuxt/a39751c.js" as="script"><link rel="preload" href="/_nuxt/d564ac5.js" as="script"><link rel="preload" href="/_nuxt/73561b8.js" as="script"><link rel="preload" href="/_nuxt/1addaae.js" as="script"><link rel="preload" href="/_nuxt/315cbe7.js" as="script"><link rel="preload" href="/_nuxt/fe7a8b7.js" as="script"><link rel="preload" href="/_nuxt/e1dbc9a.js" as="script"><link rel="preload" href="/_nuxt/css/7a3f40f.css" as="style"><link rel="preload" href="/_nuxt/a7f8645.js" as="script"><link rel="preload" href="/_nuxt/b97de85.js" as="script"><link rel="preload" href="/_nuxt/css/7cc1faa.css" as="style"><link rel="preload" href="/_nuxt/6e78f4f.js" as="script"><link rel="preload" href="/_nuxt/c3e7c0b.js" as="script"><link rel="preload" href="/_nuxt/8e87f09.js" as="script"><link rel="preload" href="/_nuxt/970d5f6.js" as="script"><link rel="preload" href="/_nuxt/8fc555f.js" as="script"><link rel="preload" href="/_nuxt/1a62231.js" as="script"><link rel="preload" href="/_nuxt/e01b6c1.js" as="script"><link rel="preload" href="/_nuxt/3d41815.js" as="script"><link rel="stylesheet" href="/_nuxt/css/7a3f40f.css"><link rel="stylesheet" href="/_nuxt/css/7cc1faa.css">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div id="main"><header><div class="header-container"><a href="/handbook"><div class="header-title">Developer <span class="green">HandBook</span></div></a> <a id="archive_link" href="/handbook/archive" title="List archive articles"><img src="/_nuxt/img/archive.18d9427.svg"></a> <div id="menu"><div></div> <div></div> <div></div></div></div></header> <div class="page_content"><div class="container"><div class="handbook-wrapper"><div class="filter-wrapper"><div class="category-header"><div class="font_18_bold_21 title">Filters</div> <div class="font_16_500_19">Category</div></div> <div class="category-list"><a href="/handbook/" class="category-item">
            All
        </a> <a href="/handbook/linux" class="category-item active">
            Linux
        </a><a href="/handbook/pelican" class="category-item">
            Pelican
        </a><a href="/handbook/docker" class="category-item">
            Docker
        </a><a href="/handbook/postgresql" class="category-item">
            PostgreSQL
        </a><a href="/handbook/c" class="category-item">
            C
        </a></div></div> <div class="result-filter-wrapper"><!----> <div class="article-list-container-wrapper"><div class="article-list-container"><div class="article-detail-page"><h2>How to clone linux server with rsync</h2> <div class="tease"><div><p>How to clone linux VPS server or folder with rsync.</p>
</div></div> <div class="article-body"><div><p>Check rsync installation</p>
<pre><code class="language-bash">rsync --version
</code></pre>
<p>And install rsync if need</p>
<pre><code class="language-bash">apt install rsync 
</code></pre>
<p>Create exclude file contains directoies list /root/exclude-files.txt with content:</p>
<pre><code>/boot
/dev
/tmp
/sys
/proc
/backup
/etc/fstab
/etc/mtab
/etc/mdadm.conf
/etc/sysconfig/network*
</code></pre>
<p>These directories will not be copied  </p>
<p>Check ssh access from sourse to destination server.
Clone server by command:  </p>
<pre><code>sudo rsync -vPa -e 'ssh -o StrictHostKeyChecking=no' --exclude-from=/root/exclude-files.txt / user@remote_ip:/
</code></pre>
</div></div> <div class="tag-wrapper"></div> <div class="result-filter-header article"><a href="/handbook/linux" class="button">Back to category:
            Linux
        </a></div></div></div> <!----></div></div></div></div></div> <!----> <footer><div class="footer-container"><div class="footer-wrapper"><div class="footer-item-link"><a href="/">
                    Home
                </a></div> <div class="footer-item-link"><a href="/handbook">
                    HandBook
                </a></div> <div class="footer-item-link"><a href="/handbook/archive">
                    Archive
                </a></div> <div class="footer-item-link"><a href="/about">
                    About
                </a></div></div></div></footer></div></div></div><script>window.__NUXT__=function(r,n,e,s,t,a,o,i,d,l,c,u,p,m,g,h,b,f,y,k,w,v,S,C,x,_,q,E,T,A,L,R,P,U,D){return x[0]={id:1,slug:u,name:p,entries:[{id:13,title:m,slug:g,tease:h,body:b,draft:r},{id:12,title:i,slug:d,tease:l,body:c,draft:n},{id:11,title:e,slug:s,tease:t,body:a,draft:n},{id:9,title:o,slug:f,tease:y,body:k,draft:r},{id:7,title:w,slug:v,tease:S,body:C,draft:r},{id:3,title:_,slug:q,tease:E,body:T,draft:r},{id:1,title:A,slug:L,tease:R,body:P,draft:r}]},x[1]={id:3,slug:"pelican",name:"Pelican",entries:[{id:5,title:"Pelican Tutorial",slug:"pelican-tutorial",tease:"Tutorial for Pelican, static site generator, written in Python.",body:"python3 install from pip3\r\n\r\n```bash\r\npip3 install pelican markdown\r\n```\r\n\r\nQuick initial project\r\n\r\n```bash\r\npelican-quickstart\r\n```\r\n\r\n\r\nSetup pelicanconf.py for local developing\r\n\r\n```bash\r\nRELATIVE_URLS =True\r\n```\r\n\r\nRun develop server\r\n\r\n```bash\r\nmake devserver\r\n\r\npelican --list\r\n```\r\n\r\nBuild with options\r\n\r\n```bash\r\npelican -s pelicanconf.py -o output -D\r\n```\r\n\r\nDownload templates\r\n\r\n```bash\r\ngit clone --recursive https://github.com/getpelican/pelicanthemes.git\r\n```\r\n\r\nSelect theme, copy to <code>/theme/</code> on root project and set you THEME on pelicanconf.py for customisation\r\n\r\n```bash\r\nTHEME='/theme/{{your_theme}}/';\r\n```",draft:r}]},x[2]={id:2,slug:"docker",name:"Docker",entries:[{id:8,title:"Docker Commands",slug:"docker-commands",tease:"Most used.",body:'Build image\r\n\r\n```bash\r\ndocker build . -t tagname\r\n```\r\n\r\nShell inside container, etc...\r\n\r\n```bash\r\ndocker exec -it image sh\r\n```\r\n\r\nShow logs\r\n\r\n```bash\r\ndocker logs image 2>&1 |  grep "string"\r\n```\r\n\r\n\r\nGet dump.sql from container\r\n\r\n```bash\r\ndocker exec -it image pg_dump -U username database &gt; dump.sql\r\n```\r\n\r\nRestore from  dump.sql to container\r\n\r\n```bash\r\ncat dump.sql | docker exec -i image psql -U username -d database\r\n```\r\n\r\nClear old image\r\n\r\n```bash\r\ndocker system prune -a\r\n```\r\n\r\nReload image and run demon in docker-compose\r\n\r\n```bash\r\ndocker-compose stop image\r\ndocker-compose rm image\r\ndocker-compose up -d image\r\n```',draft:r}]},x[3]={id:4,slug:"postgresql",name:"PostgreSQL",entries:[{id:6,title:"Posgres commands",slug:"posgres-commands",tease:"Useful command",body:'<p>Save backup to dump.sql</p>\r\n<div class="highlight"><pre><span></span><code>pg_dump --clean -U username database  &gt; dump.sql\r\n</code></pre></div>\r\n\r\nRestore dump.sql shell\r\n\r\n```bash\r\nsudo -i -u postgres psql -d database < dump.sql\r\n```\r\nand database\r\n\r\n```bash\r\npsql -U postgres -d database < dump.sql\r\n```\r\n\r\n-f for automatic delete old table when dump restore. Dump crating with "drop if exist" table directive.\r\n\r\n```bash\r\npsql --username username --dbname database -f dump.sql\r\n```',draft:r},{id:2,title:"Install PostgreSQL",slug:"install-postgres",tease:"Ubuntu/Debain install postgreSQL tutorial",body:"``` bash\r\nsudo apt-get update\r\nsudo apt-get install postgresql postgresql-contrib\r\n```\r\nCheck install\r\n\r\n```\r\nsudo -i -u postgres psql\r\n```\r\n\r\nCreate user in system\r\n\r\n```bash\r\nsudo adduser username\r\n```\r\n\r\nAdd postgres user \r\n\r\n```bash\r\nsudo -u postgres createuser --interactive\r\n```\r\n\r\nAnd see\r\n\r\n```bash\r\nEnter name of role to add: username\r\nShall the new role be a superuser? (y/n) y\r\n```\r\n\r\nCreate database\r\n\r\n```bash\r\nsudo -u postgres createdb username\r\n```\r\n\r\nEnter on postgres\r\n\r\n```bash\r\nsudo -u username psql\r\n```\r\n\r\nSet privileges\r\n\r\n```postgresql\r\nGRANT ALL PRIVILEGES ON DATABASE  dbname TO username;\r\n```\r\n\r\nSet password for user\r\n\r\n```postgresql\r\nALTER USER username WITH PASSWORD 'password';\r\n```\r\nSet owner\r\n\r\n```postgresql\r\nALTER DATABASE dbname OWNER TO username;\r\n```",draft:r}]},x[4]={id:5,slug:"c",name:"C",entries:[{id:10,title:"Build simple programm on C",slug:"build-c",tease:"How-to build simple programm on C",body:"```bash\r\ngcc -o hello_world hello_world.c\r\n```\r\n\r\nCompile gtk3\r\n\r\n```bash\r\ngcc `pkg-config --cflags gtk+-3.0` -o program program.c `pkg-config --libs gtk+-3.0`\r\n```\r\n\r\nCompile OpenGl\r\n\r\n```bash\r\ngcc program.c -o program -L/usr/X11R6/lib/ -lGL -lGLU -lglut\r\n```\r\n\r\nCheck memory leak\r\n\r\n```bash\r\nvalgrind --leak-check=full ./program \r\n```",draft:r}]},U.id=11,U.title=e,U.slug=s,U.category={id:1,slug:u,name:p,entries:[{id:13,title:m,slug:g,tease:h,body:b,draft:r},{id:12,title:i,slug:d,tease:l,body:c,draft:n},{id:11,title:e,slug:s,tease:t,body:a,draft:n},{id:9,title:o,slug:f,tease:y,body:k,draft:r},{id:7,title:w,slug:v,tease:S,body:C,draft:r},{id:3,title:_,slug:q,tease:E,body:T,draft:r},{id:1,title:A,slug:L,tease:R,body:P,draft:r}]},U.tease=t,U.body=a,U.draft=n,{layout:"default",data:[[x,U]],fetch:{},error:D,state:{open_panel:n,board:{posts:[]},core:{},handbook:{categories:x,category:n,category_articles:[],articles:[],article:U}},serverRendered:r,routePath:"/handbook/linux/how-clone-linux-server-rsync",config:{_app:{basePath:"/",assetsPath:"/_nuxt/",cdnURL:D}}}}(!0,!1,"How to clone linux server with rsync","how-clone-linux-server-rsync","How to clone linux VPS server or folder with rsync.","Check rsync installation\r\n\r\n\r\n```bash\r\nrsync --version\r\n```\r\n\r\nAnd install rsync if need\r\n\r\n```bash\r\napt install rsync \r\n```\r\n\r\n\r\nCreate exclude file contains directoies list /root/exclude-files.txt with content:\r\n\r\n```\r\n/boot\r\n/dev\r\n/tmp\r\n/sys\r\n/proc\r\n/backup\r\n/etc/fstab\r\n/etc/mtab\r\n/etc/mdadm.conf\r\n/etc/sysconfig/network*\r\n```\r\n\r\nThese directories will not be copied  \r\n\r\nCheck ssh access from sourse to destination server.\r\nClone server by command:  \r\n\r\n```\r\nsudo rsync -vPa -e 'ssh -o StrictHostKeyChecking=no' --exclude-from=/root/exclude-files.txt / user@remote_ip:/\r\n```","Change file encoding","How to copy image from disk with DD","how-copy-image-disk-dd","Using DD for disk cloning",'Create snapshot.\r\n\r\n```\r\nssh root@ip_of_vps_server "dd if=/dev/sda " | dd of=disk.img\r\n```\r\n\r\nRestore from image.\r\n\r\n```\r\ndd if=disk.img | ssh root@ip_of_new_vps "dd of=/dev/sda"\r\n```',"linux","Linux","How to get disk and folder size in linux","how-get-disk-and-folder-size-linux","How to get disk and folder size in linux with comamnd df and du","Show disk  space.\r\n\r\n```\r\ndf -h \r\n```\r\n\r\nFolder size from root on depth 1 step\r\n\r\n```\r\ndu -ha / -d 1 \r\n```","change-encoding","Ð¡heck and change file's encoding from the command-line in Linux with iconv.","Check.\r\n\r\n```bash\r\nfile -i input.file\r\n```\r\n\r\nChange encoding, example from  ISO-8859-1 to UTF-8\r\n\r\n```bash\r\niconv -f ISO-8859-1 -t UTF-8 input.file -o out.file\r\n```\r\n\r\nCheck encoding out file.\r\n\r\n```bash\r\nfile -i out.file \r\n```","Midnight Commander","midnight-commander","Midnight Commander chortcuts.","Copy to buffer\r\n\r\n```bash\r\n(hold) Shift + Select with mouse\r\n```\r\n\r\nPast on window\r\n\r\n```bash\r\nCtrl+V\r\n```\r\n\r\nInser buffer in PuTTY / MC\r\n\r\n```bash\r\nShift + Ins\r\n```",Array(5),"Synaptic","synaptic","Install quick filter for GUI interface","Install apt-xapian-index packege\r\n\r\n```bash\r\nsudo apt-get update\r\nsudo apt-get install apt-xapian-index\r\n```","Automate SSH login","automate-ssh-login-without-pass","Create automate SSH login without password input","Generate key for remote host\r\n\r\n```bash\r\nssh-keygen -t rsa -b 2048\r\nGenerating public/private rsa key pair.\r\nEnter file in which to save the key (/home/username/.ssh/id_rsa): \r\nEnter passphrase (empty for no passphrase): \r\nEnter same passphrase again: \r\nYour identification has been saved in /home/username/.ssh/id_rsa.\r\nYour public key has been saved in /home/username/.ssh/id_rsa.pub.\r\n```\r\n\r\nCopy on remote host\r\n\r\n```bash\r\nssh-copy-id username@server_ip\r\n```\r\n\r\nEnter password to access\r\n\r\n```bash\r\nusername@server_ip password: \r\n```\r\n\r\nLogging on ssh without password \r\n\r\n```bash\r\nssh username@server_ip\r\n```",{},null)</script><script src="/_nuxt/c1207c2.js" defer></script><script src="/_nuxt/c3e7c0b.js" defer></script><script src="/_nuxt/8e87f09.js" defer></script><script src="/_nuxt/970d5f6.js" defer></script><script src="/_nuxt/8fc555f.js" defer></script><script src="/_nuxt/1a62231.js" defer></script><script src="/_nuxt/e01b6c1.js" defer></script><script src="/_nuxt/3d41815.js" defer></script><script src="/_nuxt/1c61392.js" defer></script><script src="/_nuxt/bcfb4b6.js" defer></script><script src="/_nuxt/9f49bbb.js" defer></script><script src="/_nuxt/727b6a8.js" defer></script><script src="/_nuxt/36fa5d3.js" defer></script><script src="/_nuxt/8211618.js" defer></script><script src="/_nuxt/c1ef7aa.js" defer></script><script src="/_nuxt/1acd4c1.js" defer></script><script src="/_nuxt/79af1bc.js" defer></script><script src="/_nuxt/aa7462a.js" defer></script><script src="/_nuxt/b310c4b.js" defer></script><script src="/_nuxt/d7a45d7.js" defer></script><script src="/_nuxt/f112379.js" defer></script><script src="/_nuxt/282e78f.js" defer></script><script src="/_nuxt/dbf037d.js" defer></script><script src="/_nuxt/0ff3dc4.js" defer></script><script src="/_nuxt/123fd26.js" defer></script><script src="/_nuxt/6b51ad5.js" defer></script><script src="/_nuxt/04ef250.js" defer></script><script src="/_nuxt/78d4aff.js" defer></script><script src="/_nuxt/78c712f.js" defer></script><script src="/_nuxt/4ad9a01.js" defer></script><script src="/_nuxt/a39751c.js" defer></script><script src="/_nuxt/d564ac5.js" defer></script><script src="/_nuxt/73561b8.js" defer></script><script src="/_nuxt/1addaae.js" defer></script><script src="/_nuxt/315cbe7.js" defer></script><script src="/_nuxt/fe7a8b7.js" defer></script><script src="/_nuxt/e1dbc9a.js" defer></script><script src="/_nuxt/a7f8645.js" defer></script><script src="/_nuxt/b97de85.js" defer></script><script src="/_nuxt/6e78f4f.js" defer></script>
  </body>
</html>
